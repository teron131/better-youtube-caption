{
  "version": 3,
  "sources": ["../src/constants.js", "../src/utils/logger.js", "../src/storage.js", "../src/url.js", "../src/utils/ui.js", "../src/utils/combobox.js", "../src/utils/fontSize.js", "../src/utils/popupSettings.js", "../src/utils/generation.js", "../src/utils/loadSummary.js", "../src/utils/messageHandler.js", "../src/utils/tooltip.js", "../src/popup.js"],
  "sourcesContent": ["// Constants for Better YouTube Caption Extension\n\n// Storage keys\nexport const STORAGE_KEYS = {\n  SCRAPE_CREATORS_API_KEY: \"scrapeCreatorsApiKey\",\n  OPENROUTER_API_KEY: \"openRouterApiKey\",\n  SUMMARIZER_RECOMMENDED_MODEL: \"summarizerRecommendedModel\",\n  SUMMARIZER_CUSTOM_MODEL: \"summarizerCustomModel\",\n  REFINER_RECOMMENDED_MODEL: \"refinerRecommendedModel\",\n  REFINER_CUSTOM_MODEL: \"refinerCustomModel\",\n  AUTO_GENERATE: \"autoGenerate\",\n  SHOW_SUBTITLES: \"showSubtitles\",\n  CAPTION_FONT_SIZE: \"captionFontSize\",\n  SUMMARY_FONT_SIZE: \"summaryFontSize\",\n  TARGET_LANGUAGE_RECOMMENDED: \"targetLanguageRecommended\",\n  TARGET_LANGUAGE_CUSTOM: \"targetLanguageCustom\",\n};\n\n// Timing constants\nexport const TIMING = {\n  AUTO_GENERATION_DELAY_MS: 2000, // 2 seconds delay before auto-generation\n  INIT_RETRY_DELAY_MS: 500, // Delay between initialization retries\n  SUBTITLE_UPDATE_INTERVAL_MS: 100, // How often to update subtitle display\n  MAX_INIT_ATTEMPTS: 5, // Maximum retry attempts for finding video elements\n};\n\n// Storage constants\nexport const STORAGE = {\n  QUOTA_BYTES: 10 * 1024 * 1024, // 10MB Chrome storage limit\n  MAX_STORAGE_BYTES: 9.5 * 1024 * 1024, // 9.5MB - leave 0.5MB buffer\n  ESTIMATED_VIDEO_SIZE_BYTES: 30 * 1024, // Estimated ~30KB per video transcript\n  CLEANUP_BATCH_SIZE: 10, // Number of videos to remove during cleanup\n};\n\n// New separate lists for summarizer and refiner\nexport const RECOMMENDED_SUMMARIZER_MODELS = [\n  { value: \"x-ai/grok-4.1-fast\", label: \"Grok 4.1 Fast\" },\n  { value: \"x-ai/grok-4\", label: \"Grok 4\" },\n  { value: \"google/gemini-2.5-flash\", label: \"Gemini 2.5 Flash\" },\n  { value: \"google/gemini-3-pro-preview\", label: \"Gemini 3 Pro\" },\n  { value: \"openai/gpt-5-mini\", label: \"GPT-5 Mini\" },\n  { value: \"openai/gpt-5.1\", label: \"GPT-5.1\" },\n  { value: \"anthropic/claude-haiku-4.5\", label: \"Claude Haiku 4.5\" },\n  { value: \"anthropic/claude-sonnet-4.5\", label: \"Claude Sonnet 4.5\" },\n];\n\nexport const RECOMMENDED_REFINER_MODELS = [\n  { value: \"google/gemini-2.5-flash-lite-preview-09-2025\", label: \"Gemini 2.5 Flash Lite\" },\n  { value: \"x-ai/grok-4.1-fast\", label: \"Grok 4.1 Fast\" },\n];\n\n// Target language options for summarization\nexport const TARGET_LANGUAGES = [\n  { value: \"auto\", label: \"\uD83C\uDF10 Auto\" },\n  { value: \"en\", label: \"\uD83C\uDDFA\uD83C\uDDF8 English\" },\n  { value: \"zh-TW\", label: \"\uD83C\uDDED\uD83C\uDDF0 Chinese\" },\n];\n\n// Default values\nexport const DEFAULTS = {\n  MODEL_SUMMARIZER: \"x-ai/grok-4.1-fast\",\n  MODEL_REFINER: \"google/gemini-2.5-flash-lite-preview-09-2025\",\n  AUTO_GENERATE: false,\n  SHOW_SUBTITLES: true, // Subtitles shown by default\n  CAPTION_FONT_SIZE: \"M\", // Medium\n  SUMMARY_FONT_SIZE: \"M\", // Medium\n  TARGET_LANGUAGE_RECOMMENDED: \"auto\", // Auto-detect language\n  TARGET_LANGUAGE_CUSTOM: \"\", // Custom language code\n};\n\n// Font size mappings\nexport const FONT_SIZES = {\n  CAPTION: {\n    S: { base: \"1.4vw\", max: \"22px\", min: \"12px\", fullscreen: \"1.7vw\", fullscreenMax: \"28px\" },\n    M: { base: \"1.8vw\", max: \"28px\", min: \"14px\", fullscreen: \"2.2vw\", fullscreenMax: \"36px\" },\n    L: { base: \"2.2vw\", max: \"34px\", min: \"16px\", fullscreen: \"2.7vw\", fullscreenMax: \"44px\" },\n  },\n  SUMMARY: {\n    S: { base: \"13px\", h2: \"17px\", h3: \"15px\" },\n    M: { base: \"15px\", h2: \"20px\", h3: \"17px\" },\n    L: { base: \"17px\", h2: \"23px\", h3: \"19px\" },\n  },\n};\n\n// API endpoints\nexport const API_ENDPOINTS = {\n  SCRAPE_CREATORS: \"https://api.scrapecreators.com/v1/youtube/video\",\n  OPENROUTER: \"https://openrouter.ai/api/v1/chat/completions\",\n};\n\n// YouTube-specific constants\nexport const YOUTUBE = {\n  VIDEO_ID_LENGTH: 11, // Standard YouTube video ID length\n  SELECTORS: {\n    VIDEO_PLAYER: \"video.html5-main-video\",\n    MOVIE_PLAYER: \"#movie_player\",\n    VIDEO_CONTAINER: \".html5-video-container\",\n  },\n};\n\n// Message actions\nexport const MESSAGE_ACTIONS = {\n  FETCH_SUBTITLES: \"fetchSubtitles\",\n  GENERATE_SUBTITLES: \"generateSubtitles\",\n  GENERATE_SUMMARY: \"generateSummary\",\n  SUBTITLES_GENERATED: \"subtitlesGenerated\",\n  SUMMARY_GENERATED: \"summaryGenerated\",\n  UPDATE_POPUP_STATUS: \"updatePopupStatus\",\n  TOGGLE_SUBTITLES: \"toggleSubtitles\",\n  GET_VIDEO_TITLE: \"getVideoTitle\",\n  SHOW_ERROR: \"showError\",\n  UPDATE_CAPTION_FONT_SIZE: \"updateCaptionFontSize\",\n};\n\n// Element IDs\nexport const ELEMENT_IDS = {\n  SUBTITLE_CONTAINER: \"youtube-gemini-subtitles-container\",\n  SUBTITLE_TEXT: \"youtube-gemini-subtitles-text\",\n};\n\nexport const REFINER_CONFIG = {\n  MAX_SEGMENTS_PER_CHUNK: 30,\n  CHUNK_SENTINEL: \"<<<__CHUNK_END__>>>\",\n};\n", "/**\n * Lightweight logger shared by content/popup/background.\n * Prefixes logs and can be toggled via DEBUG flag.\n */\n\nconst PREFIX = 'Better YouTube Caption:';\nlet DEBUG = true;\n\nexport const log = (...args) => {\n  if (!DEBUG) return;\n  console.log(PREFIX, ...args);\n};\n\nexport const info = (...args) => {\n  if (!DEBUG) return;\n  console.info(PREFIX, ...args);\n};\n\nexport const warn = (...args) => {\n  if (!DEBUG) return;\n  console.warn(PREFIX, ...args);\n};\n\nexport const error = (...args) => {\n  console.error(PREFIX, ...args);\n};\n\nexport const setDebug = (enabled) => {\n  DEBUG = !!enabled;\n};\n\nexport const getDebugEnabled = () => DEBUG;\n\nconst logger = { log, info, warn, error, setDebug, get debugEnabled() { return DEBUG; } };\nexport default logger;\n", "/**\n * Storage Management Utilities\n * Uses video IDs as storage keys for better robustness\n */\n\nimport { STORAGE, YOUTUBE } from \"./constants.js\";\nimport { log } from \"./utils/logger.js\";\n\n/**\n * Get subtitles for a video from local storage\n */\nexport function getStoredSubtitles(videoId) {\n  return new Promise((resolve) => {\n    chrome.storage.local.get([videoId], (result) => {\n      resolve(result[videoId] || null);\n    });\n  });\n}\n\n/**\n * Save subtitles for a video to local storage with quota management\n */\nexport function saveSubtitles(videoId, subtitles) {\n  return new Promise((resolve, reject) => {\n    chrome.storage.local.set({ [videoId]: subtitles }, () => {\n      if (chrome.runtime.lastError) {\n        if (chrome.runtime.lastError.message?.includes(\"QUOTA\")) {\n          console.warn(\"Storage quota exceeded, attempting cleanup...\");\n          cleanupOldSubtitles(STORAGE.CLEANUP_BATCH_SIZE)\n            .then(() => {\n              chrome.storage.local.set({ [videoId]: subtitles }, () => {\n                if (chrome.runtime.lastError) {\n                  reject(new Error(`Storage quota exceeded: ${chrome.runtime.lastError.message}`));\n                } else {\n                  console.log(\"Subtitles saved after cleanup for video:\", videoId);\n                  resolve();\n                }\n              });\n            })\n            .catch((error) => reject(new Error(`Storage quota exceeded and cleanup failed: ${error.message}`)));\n        } else {\n          reject(new Error(chrome.runtime.lastError.message));\n        }\n      } else {\n        console.log(\"Subtitles saved to local storage for video ID:\", videoId);\n        resolve();\n      }\n    });\n  });\n}\n\n/**\n * Get storage usage information\n */\nexport function getStorageUsage() {\n  return new Promise((resolve) => {\n    chrome.storage.local.getBytesInUse(null, (bytesInUse) => {\n      resolve({\n        bytesUsed: bytesInUse || 0,\n        bytesAvailable: STORAGE.QUOTA_BYTES - (bytesInUse || 0),\n        percentageUsed: ((bytesInUse || 0) / STORAGE.QUOTA_BYTES) * 100,\n      });\n    });\n  });\n}\n\n/**\n * Clean up old subtitles when storage is full\n */\nexport async function cleanupOldSubtitles(countToRemove = 10) {\n  return new Promise((resolve, reject) => {\n    chrome.storage.local.get(null, (allItems) => {\n      if (chrome.runtime.lastError) {\n        reject(new Error(chrome.runtime.lastError.message));\n        return;\n      }\n\n      // Filter for video IDs (11 chars, array values)\n      const videoKeys = Object.keys(allItems).filter(\n        (key) => key.length === YOUTUBE.VIDEO_ID_LENGTH && Array.isArray(allItems[key])\n      );\n\n      const keepCount = 5; // Keep at least 5 videos\n      const removeCount =\n        videoKeys.length <= countToRemove ? Math.max(1, videoKeys.length - keepCount) : countToRemove;\n\n      const keysToRemove = videoKeys.slice(0, removeCount);\n      chrome.storage.local.remove(keysToRemove, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message));\n        } else {\n          console.log(`Removed ${keysToRemove.length} old video transcripts`);\n          resolve();\n        }\n      });\n    });\n  });\n}\n\n/**\n * Proactively check and clean storage if needed\n */\nexport async function ensureStorageSpace() {\n  const usage = await getStorageUsage();\n\n  if (usage.bytesUsed > STORAGE.MAX_STORAGE_BYTES) {\n    console.log(`Storage usage at ${usage.percentageUsed.toFixed(1)}%, cleaning up...`);\n    const videosToRemove = Math.ceil(\n      (usage.bytesUsed - STORAGE.MAX_STORAGE_BYTES) / STORAGE.ESTIMATED_VIDEO_SIZE_BYTES\n    );\n    await cleanupOldSubtitles(videosToRemove);\n  }\n}\n\n/**\n * Get API key from storage\n */\nexport function getApiKeyFromStorage(keyName) {\n  return new Promise((resolve) => {\n    chrome.storage.local.get([keyName], (result) => {\n      resolve(result[keyName] || null);\n    });\n  });\n}\n\n/**\n * Save API key to storage\n */\nexport function saveApiKey(keyName, apiKey) {\n  return new Promise((resolve, reject) => {\n    chrome.storage.local.set({ [keyName]: apiKey }, () => {\n      if (chrome.runtime.lastError) {\n        reject(new Error(chrome.runtime.lastError.message));\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\n/**\n * Save a setting to storage\n * @param {string} key - Storage key\n * @param {*} value - Value to save\n */\nexport function saveSetting(key, value) {\n  const settings = { [key]: value };\n  chrome.storage.local.set(settings, () => {\n    log('Auto-saved:', key, value);\n  });\n}\n", "/**\n * URL Utility Functions\n */\n\n/**\n * Clean YouTube URL to extract only video ID and essential parameters\n */\nexport function cleanYouTubeUrl(originalUrl) {\n  try {\n    const url = new URL(originalUrl);\n    const videoId = url.searchParams.get(\"v\");\n    if (videoId) {\n      return `${url.protocol}//${url.hostname}${url.pathname}?v=${videoId}`;\n    }\n  } catch (e) {\n    console.error(\"Error parsing URL:\", originalUrl, e);\n  }\n  return originalUrl;\n}\n\n/**\n * Extract video ID from YouTube URL\n */\nexport function extractVideoId(url) {\n  try {\n    const urlObj = new URL(url);\n    return urlObj.searchParams.get(\"v\");\n  } catch (e) {\n    console.error(\"Error extracting video ID:\", url, e);\n    return null;\n  }\n}\n", "/**\n * UI Utility Functions\n * Provides common UI manipulation helpers\n */\n\n/**\n * Create provider icon element\n * @param {string} provider - Provider name (e.g., 'google', 'openai')\n * @returns {string} Icon path or empty string\n */\nexport function getProviderIcon(provider) {\n  const icons = {\n    anthropic: 'images/anthropic.svg',\n    google: 'images/google.svg',\n    openai: 'images/openai.svg',\n    'x-ai': 'images/xai.svg',\n  };\n  return icons[provider] || '';\n}\n\n/**\n * Create option element for custom select dropdown\n * @param {Object} model - Model object with value and label\n * @param {string} type - Model type ('summarizer' or 'refiner')\n * @returns {HTMLElement} Option element\n */\nexport function createOptionElement(model, type) {\n  const item = document.createElement('div');\n  item.className = 'select-item';\n  item.dataset.value = model.value;\n\n  const icon = document.createElement('span');\n  icon.className = 'item-icon';\n  \n  if (type === 'targetLanguage') {\n    // For language select, extract emoji from label and put it in icon\n    const labelText = model.label || model.value;\n    // Match emoji at the start of the label (e.g., \"\uD83C\uDF10 Auto\", \"\uD83C\uDDFA\uD83C\uDDF8 English\")\n    const emojiMatch = labelText.match(/^(\\p{Emoji}+)\\s*(.+)$/u);\n    if (emojiMatch) {\n      const emoji = emojiMatch[1];\n      icon.textContent = emoji;\n      icon.style.fontSize = '16px';\n      icon.style.lineHeight = '16px';\n      icon.style.display = 'flex';\n      icon.style.alignItems = 'center';\n      icon.style.justifyContent = 'center';\n    }\n  } else {\n    // For model selects, show provider icon\n    const provider = model.value.split('/')[0];\n    const iconSrc = getProviderIcon(provider);\n    if (iconSrc) {\n      const img = document.createElement('img');\n      img.src = iconSrc;\n      img.alt = provider;\n      img.width = 16;\n      img.height = 16;\n      icon.appendChild(img);\n    }\n  }\n  item.appendChild(icon);\n\n  const label = document.createElement('span');\n  label.className = 'item-label';\n  if (type === 'targetLanguage') {\n    // For language select, remove emoji from label text (it's now in icon)\n    const labelText = model.label || model.value;\n    const emojiMatch = labelText.match(/^(\\p{Emoji}+)\\s*(.+)$/u);\n    label.textContent = emojiMatch ? emojiMatch[2].trim() : labelText;\n  } else {\n    label.textContent = model.label || model.value;\n  }\n  item.appendChild(label);\n\n  return item;\n}\n\n/**\n * Update select dropdown UI with selected value\n * @param {HTMLElement} selectElement - Select element\n * @param {string} value - Selected value\n * @param {string} labelText - Display label\n */\nexport function updateSelectDisplay(selectElement, value, labelText) {\n  const selected = selectElement.querySelector('.select-selected');\n  if (!selected) return;\n\n  const provider = value.split('/')[0];\n  const iconSrc = getProviderIcon(provider);\n  const iconSpan = selected.querySelector('.select-icon');\n  \n  iconSpan.innerHTML = '';\n  if (iconSrc) {\n    const img = document.createElement('img');\n    img.src = iconSrc;\n    img.alt = provider;\n    img.width = 16;\n    img.height = 16;\n    iconSpan.appendChild(img);\n  }\n  \n  const labelElement = selected.querySelector('.select-label');\n  if (labelElement) {\n    labelElement.textContent = labelText;\n  }\n}\n\n/**\n * Sanitize YouTube video title\n * @param {string} title - Raw title\n * @returns {string} Sanitized title\n */\nexport function sanitizeTitle(title) {\n  if (typeof title !== 'string') {\n    return '';\n  }\n\n  return title\n    .replace(/^\\(\\d+\\)\\s*/, '')\n    .replace(/\\s*-\\s*YouTube$/i, '')\n    .trim();\n}\n\n/**\n * Escape HTML to prevent XSS\n * @param {string} text - Text to escape\n * @returns {string} Escaped HTML\n */\nexport function escapeHTML(text) {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Format inline markdown (bold, italic, code)\n * @param {string} text - Text with markdown\n * @returns {string} HTML formatted text\n */\nexport function formatInlineMarkdown(text) {\n  // Process markdown patterns before escaping\n  // Bold (**text** or __text__)\n  text = text.replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>');\n  text = text.replace(/__(.+?)__/g, '<strong>$1</strong>');\n  \n  // Italic (*text* or _text_) - only match if not part of bold\n  text = text.replace(/(?<!\\*)\\*([^*]+?)\\*(?!\\*)/g, '<em>$1</em>');\n  text = text.replace(/(?<!_)_([^_]+?)_(?!_)/g, '<em>$1</em>');\n  \n  // Code (`text`)\n  text = text.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Split by HTML tags, escape non-tag parts, then rejoin\n  const parts = text.split(/(<[^>]+>)/g);\n  const result = parts.map((part, index) => {\n    // Odd indices are HTML tags, keep them as-is\n    if (index % 2 === 1) {\n      return part;\n    }\n    // Even indices are text content, escape it\n    return escapeHTML(part);\n  });\n  \n  return result.join('');\n}\n\n/**\n * Convert markdown to HTML\n * @param {string} markdown - Markdown text\n * @returns {string} HTML string\n */\nexport function convertMarkdownToHTML(markdown) {\n  if (!markdown || typeof markdown !== 'string') {\n    return '<div class=\"summary-placeholder\">No summary available</div>';\n  }\n\n  const lines = markdown.split('\\n');\n  const result = [];\n  let inList = false;\n  let inParagraph = false;\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    \n    // Skip empty lines\n    if (!line) {\n      if (inList) {\n        result.push('</ul>');\n        inList = false;\n      }\n      if (inParagraph) {\n        result.push('</p>');\n        inParagraph = false;\n      }\n      continue;\n    }\n\n    // Headers\n    if (line.match(/^###\\s+(.+)$/)) {\n      if (inList) {\n        result.push('</ul>');\n        inList = false;\n      }\n      if (inParagraph) {\n        result.push('</p>');\n        inParagraph = false;\n      }\n      const headerText = line.replace(/^###\\s+/, '');\n      result.push(`<h3>${escapeHTML(headerText)}</h3>`);\n    } else if (line.match(/^##\\s+(.+)$/)) {\n      if (inList) {\n        result.push('</ul>');\n        inList = false;\n      }\n      if (inParagraph) {\n        result.push('</p>');\n        inParagraph = false;\n      }\n      const headerText = line.replace(/^##\\s+/, '');\n      result.push(`<h2>${escapeHTML(headerText)}</h2>`);\n    } else if (line.match(/^#\\s+(.+)$/)) {\n      if (inList) {\n        result.push('</ul>');\n        inList = false;\n      }\n      if (inParagraph) {\n        result.push('</p>');\n        inParagraph = false;\n      }\n      const headerText = line.replace(/^#\\s+/, '');\n      result.push(`<h2>${escapeHTML(headerText)}</h2>`);\n    }\n    // Bullet lists\n    else if (line.match(/^[\\*\\-\u2022]\\s+(.+)$/)) {\n      if (inParagraph) {\n        result.push('</p>');\n        inParagraph = false;\n      }\n      if (!inList) {\n        result.push('<ul>');\n        inList = true;\n      }\n      const listItemText = line.replace(/^[\\*\\-\u2022]\\s+/, '');\n      result.push(`<li>${formatInlineMarkdown(listItemText)}</li>`);\n    }\n    // Regular paragraph text\n    else {\n      if (inList) {\n        result.push('</ul>');\n        inList = false;\n      }\n      if (!inParagraph) {\n        result.push('<p>');\n        inParagraph = true;\n      } else {\n        result.push('<br>');\n      }\n      result.push(formatInlineMarkdown(line));\n    }\n  }\n\n  // Close any open tags\n  if (inList) {\n    result.push('</ul>');\n  }\n  if (inParagraph) {\n    result.push('</p>');\n  }\n\n  return result.join('');\n}\n\n/**\n * Display summary in the UI\n * @param {string} summaryText - Summary text (markdown)\n * @param {HTMLElement} summaryElement - Summary content element\n */\nexport function displaySummary(summaryText, summaryElement) {\n  summaryElement.innerHTML = convertMarkdownToHTML(summaryText);\n}\n", "/**\n * Combobox Component\n * Combines text input with dropdown for selecting or typing values\n */\n\nimport { DEFAULTS, RECOMMENDED_REFINER_MODELS, RECOMMENDED_SUMMARIZER_MODELS, STORAGE_KEYS, TARGET_LANGUAGES } from \"../constants.js\";\nimport { saveSetting } from \"../storage.js\";\nimport { getProviderIcon } from \"./ui.js\";\n\n/**\n * Initialize comboboxes\n */\nexport function initializeComboboxes() {\n  const comboboxes = document.querySelectorAll('.combobox[data-combobox-type]');\n  \n  comboboxes.forEach(combobox => {\n    const comboboxType = combobox.dataset.comboboxType;\n    const input = combobox.querySelector('.combobox-input');\n    const arrow = combobox.querySelector('.combobox-arrow');\n    const dropdown = combobox.querySelector('.combobox-dropdown');\n    const icon = combobox.querySelector('.combobox-icon');\n    \n    if (!input || !arrow || !dropdown || !icon) return;\n    \n    // Populate dropdown based on type\n    dropdown.innerHTML = '';\n    let options = [];\n    let storageKeys = {};\n    \n    if (comboboxType === 'targetLanguage') {\n      options = TARGET_LANGUAGES;\n      storageKeys = {\n        recommended: STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED,\n        custom: STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM\n      };\n    } else if (comboboxType === 'summarizer') {\n      options = RECOMMENDED_SUMMARIZER_MODELS;\n      storageKeys = {\n        recommended: STORAGE_KEYS.SUMMARIZER_RECOMMENDED_MODEL,\n        custom: STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL\n      };\n    } else if (comboboxType === 'refiner') {\n      options = RECOMMENDED_REFINER_MODELS;\n      storageKeys = {\n        recommended: STORAGE_KEYS.REFINER_RECOMMENDED_MODEL,\n        custom: STORAGE_KEYS.REFINER_CUSTOM_MODEL\n      };\n    }\n    \n    // Populate dropdown\n    options.forEach(option => {\n      const item = createComboboxItem(option, comboboxType);\n      dropdown.appendChild(item);\n    });\n    \n    // Initial value will be set by loadSettings via setComboboxValue\n    \n    // Arrow click - toggle dropdown\n    arrow.addEventListener('click', (e) => {\n      e.stopPropagation();\n      toggleCombobox(combobox);\n    });\n    \n    // Input focus - show dropdown\n    input.addEventListener('focus', () => {\n      combobox.classList.add('open');\n      dropdown.classList.add('show');\n    });\n    \n    // Input typing - filter dropdown\n    input.addEventListener('input', (e) => {\n      filterComboboxDropdown(combobox, e.target.value);\n      // Save the value as custom\n      const value = e.target.value.trim();\n      \n      // Update icon for models when typing\n      if ((comboboxType === 'summarizer' || comboboxType === 'refiner') && value) {\n        updateComboboxModelIcon(combobox, value);\n      }\n      \n      if (value && storageKeys.custom) {\n        saveSetting(storageKeys.custom, value);\n        // Clear recommended if custom is set\n        if (storageKeys.recommended) {\n          saveSetting(storageKeys.recommended, '');\n        }\n      } else {\n        // Clear custom if empty\n        if (storageKeys.custom) {\n          saveSetting(storageKeys.custom, '');\n        }\n        // Clear icon if empty\n        if ((comboboxType === 'summarizer' || comboboxType === 'refiner') && icon) {\n          icon.innerHTML = '';\n        }\n      }\n    });\n    \n    // Dropdown item click\n    dropdown.addEventListener('click', (e) => {\n      const item = e.target.closest('.combobox-item');\n      if (!item) return;\n      \n      const value = item.dataset.value;\n      \n      // Set input value\n      input.value = value;\n      \n      // Update icon\n      if (comboboxType === 'targetLanguage') {\n        updateComboboxIcon(combobox, value);\n      } else if (comboboxType === 'summarizer' || comboboxType === 'refiner') {\n        updateComboboxModelIcon(combobox, value);\n      }\n      \n      // Update selected state in dropdown\n      dropdown.querySelectorAll('.combobox-item').forEach(i => {\n        i.classList.remove('selected');\n      });\n      item.classList.add('selected');\n      \n      // Close dropdown\n      combobox.classList.remove('open');\n      dropdown.classList.remove('show');\n      \n      // Save as recommended (clear custom)\n      if (storageKeys.recommended) {\n        saveSetting(storageKeys.recommended, value);\n      }\n      if (storageKeys.custom) {\n        saveSetting(storageKeys.custom, '');\n      }\n    });\n    \n    // Close dropdown on outside click\n    document.addEventListener('click', (e) => {\n      if (!combobox.contains(e.target)) {\n        combobox.classList.remove('open');\n        dropdown.classList.remove('show');\n      }\n    });\n  });\n}\n\n/**\n * Create combobox item element\n */\nfunction createComboboxItem(option, comboboxType) {\n  const item = document.createElement('div');\n  item.className = 'combobox-item';\n  item.dataset.value = option.value;\n  \n  const icon = document.createElement('span');\n  icon.className = 'combobox-item-icon';\n  \n  if (comboboxType === 'targetLanguage') {\n    // Extract emoji from label (only for targetLanguage)\n    const emojiMatch = option.label.match(/^(\\p{Emoji}+)\\s*(.+)$/u);\n    if (emojiMatch) {\n      icon.textContent = emojiMatch[1];\n    }\n  } else if (comboboxType === 'summarizer' || comboboxType === 'refiner') {\n    // For model selects, show provider icon\n    const provider = option.value.split('/')[0];\n    const iconSrc = getProviderIcon(provider);\n    if (iconSrc) {\n      const img = document.createElement('img');\n      img.src = iconSrc;\n      img.alt = provider;\n      img.width = 16;\n      img.height = 16;\n      icon.appendChild(img);\n    }\n  }\n  item.appendChild(icon);\n  \n  const label = document.createElement('span');\n  label.className = 'combobox-item-label';\n  \n  // Remove emoji from label text (only for targetLanguage)\n  if (comboboxType === 'targetLanguage') {\n    const emojiMatch = option.label.match(/^(\\p{Emoji}+)\\s*(.+)$/u);\n    if (emojiMatch) {\n      label.textContent = emojiMatch[2].trim();\n    } else {\n      label.textContent = option.label;\n    }\n  } else {\n    label.textContent = option.label;\n  }\n  item.appendChild(label);\n  \n  return item;\n}\n\n/**\n * Toggle combobox dropdown\n */\nfunction toggleCombobox(combobox) {\n  const dropdown = combobox.querySelector('.combobox-dropdown');\n  const isOpen = combobox.classList.contains('open');\n  \n  // Close all other comboboxes\n  document.querySelectorAll('.combobox.open').forEach(cb => {\n    if (cb !== combobox) {\n      cb.classList.remove('open');\n      cb.querySelector('.combobox-dropdown').classList.remove('show');\n    }\n  });\n  \n  if (isOpen) {\n    combobox.classList.remove('open');\n    dropdown.classList.remove('show');\n  } else {\n    combobox.classList.add('open');\n    dropdown.classList.add('show');\n    // Focus input\n    const input = combobox.querySelector('.combobox-input');\n    if (input) input.focus();\n  }\n}\n\n/**\n * Filter combobox dropdown based on input\n */\nfunction filterComboboxDropdown(combobox, filterText) {\n  const dropdown = combobox.querySelector('.combobox-dropdown');\n  const items = dropdown.querySelectorAll('.combobox-item');\n  const filterLower = filterText.toLowerCase().trim();\n  \n  items.forEach(item => {\n    const label = item.querySelector('.combobox-item-label').textContent.toLowerCase();\n    const value = item.dataset.value.toLowerCase();\n    \n    if (!filterLower || label.includes(filterLower) || value.includes(filterLower)) {\n      item.style.display = 'flex';\n    } else {\n      item.style.display = 'none';\n    }\n  });\n}\n\n/**\n * Update combobox icon based on value (for targetLanguage)\n */\nfunction updateComboboxIcon(combobox, value) {\n  const icon = combobox.querySelector('.combobox-icon');\n  if (!icon) return;\n  \n  const langOption = TARGET_LANGUAGES.find(l => l.value === value);\n  if (langOption) {\n    const emojiMatch = langOption.label.match(/^(\\p{Emoji}+)\\s*(.+)$/u);\n    if (emojiMatch) {\n      icon.textContent = emojiMatch[1];\n    } else {\n      icon.textContent = '';\n    }\n  } else {\n    icon.textContent = '';\n  }\n}\n\n/**\n * Update combobox icon for model (shows provider icon)\n */\nfunction updateComboboxModelIcon(combobox, value) {\n  const icon = combobox.querySelector('.combobox-icon');\n  if (!icon) return;\n  \n  icon.innerHTML = '';\n  if (value) {\n    const provider = value.split('/')[0];\n    const iconSrc = getProviderIcon(provider);\n    if (iconSrc) {\n      const img = document.createElement('img');\n      img.src = iconSrc;\n      img.alt = provider;\n      img.width = 16;\n      img.height = 16;\n      icon.appendChild(img);\n    }\n  }\n}\n\n/**\n * Update combobox display from storage\n */\nexport function updateComboboxDisplay(combobox) {\n  const input = combobox.querySelector('.combobox-input');\n  if (!input) return;\n  \n  // Get current value (custom takes priority)\n  chrome.storage.local.get([\n    STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM,\n    STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED\n  ], (result) => {\n    const custom = result[STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM]?.trim();\n    const recommended = result[STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED] || DEFAULTS.TARGET_LANGUAGE_RECOMMENDED;\n    \n    const value = custom || recommended;\n    input.value = value;\n    updateComboboxIcon(combobox, value);\n    \n    // Mark selected item in dropdown\n    const dropdown = combobox.querySelector('.combobox-dropdown');\n    if (dropdown) {\n      dropdown.querySelectorAll('.combobox-item').forEach(item => {\n        item.classList.remove('selected');\n        if (item.dataset.value === value) {\n          item.classList.add('selected');\n        }\n      });\n    }\n  });\n}\n\n/**\n * Set combobox value programmatically\n */\nexport function setComboboxValue(comboboxType, value) {\n  const combobox = document.querySelector(`[data-combobox-type=\"${comboboxType}\"]`);\n  if (!combobox) return;\n  \n  const input = combobox.querySelector('.combobox-input');\n  const icon = combobox.querySelector('.combobox-icon');\n  if (input) {\n    input.value = value || '';\n    \n    // Update icon\n    if (comboboxType === 'targetLanguage') {\n      updateComboboxIcon(combobox, value);\n    } else if (comboboxType === 'summarizer' || comboboxType === 'refiner') {\n      updateComboboxModelIcon(combobox, value);\n    }\n    \n    // Mark selected item\n    const dropdown = combobox.querySelector('.combobox-dropdown');\n    if (dropdown) {\n      dropdown.querySelectorAll('.combobox-item').forEach(item => {\n        item.classList.remove('selected');\n        if (item.dataset.value === value) {\n          item.classList.add('selected');\n        }\n      });\n    }\n  }\n}\n", "/**\n * Font Size Management\n * Handles font size settings for captions and summary\n */\n\nimport { DEFAULTS, FONT_SIZES, MESSAGE_ACTIONS, STORAGE_KEYS } from \"../constants.js\";\nimport { saveSetting } from \"../storage.js\";\nimport { log as logDebug } from \"./logger.js\";\n\n/**\n * Apply summary font size to summary content\n * @param {string} size - Size key (S, M, L)\n */\nfunction applySummaryFontSize(size) {\n  const sizeConfig = FONT_SIZES.SUMMARY[size] || FONT_SIZES.SUMMARY.M;\n  const summaryContent = document.getElementById('summaryContent');\n  \n  if (summaryContent) {\n    summaryContent.style.setProperty('--summary-font-size-base', sizeConfig.base);\n    summaryContent.style.setProperty('--summary-font-size-h2', sizeConfig.h2);\n    summaryContent.style.setProperty('--summary-font-size-h3', sizeConfig.h3);\n  }\n}\n\n/**\n * Initialize font size selectors\n */\nexport function initializeFontSizeSelectors() {\n  // Load saved font sizes\n  chrome.storage.local.get(\n    [STORAGE_KEYS.CAPTION_FONT_SIZE, STORAGE_KEYS.SUMMARY_FONT_SIZE],\n    (result) => {\n      const captionSize = result[STORAGE_KEYS.CAPTION_FONT_SIZE] || DEFAULTS.CAPTION_FONT_SIZE;\n      const summarySize = result[STORAGE_KEYS.SUMMARY_FONT_SIZE] || DEFAULTS.SUMMARY_FONT_SIZE;\n      \n      // Set active buttons\n      document.querySelectorAll('.font-size-button[data-type=\"caption\"]').forEach(btn => {\n        if (btn.dataset.size === captionSize) {\n          btn.classList.add('active');\n        } else {\n          btn.classList.remove('active');\n        }\n      });\n      \n      document.querySelectorAll('.font-size-button[data-type=\"summary\"]').forEach(btn => {\n        if (btn.dataset.size === summarySize) {\n          btn.classList.add('active');\n        } else {\n          btn.classList.remove('active');\n        }\n      });\n      \n      // Apply font sizes\n      applySummaryFontSize(summarySize);\n    }\n  );\n  \n  // Setup click handlers\n  document.querySelectorAll('.font-size-button').forEach(button => {\n    button.addEventListener('click', function() {\n      const size = this.dataset.size;\n      const type = this.dataset.type;\n      \n      // Update active state\n      document.querySelectorAll(`.font-size-button[data-type=\"${type}\"]`).forEach(btn => {\n        btn.classList.remove('active');\n      });\n      this.classList.add('active');\n      \n      // Save setting\n      const storageKey = type === 'caption' \n        ? STORAGE_KEYS.CAPTION_FONT_SIZE \n        : STORAGE_KEYS.SUMMARY_FONT_SIZE;\n      saveSetting(storageKey, size);\n      \n      // Apply font size\n      if (type === 'caption') {\n        // Notify content script to update caption font size\n        chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n          const currentTab = tabs[0];\n          if (currentTab && currentTab.url && currentTab.url.includes('youtube.com/watch')) {\n            chrome.tabs.sendMessage(currentTab.id, {\n              action: MESSAGE_ACTIONS.UPDATE_CAPTION_FONT_SIZE,\n              fontSize: size,\n            }, () => {\n              if (chrome.runtime.lastError) {\n                logDebug('Popup: Unable to update caption font size:', chrome.runtime.lastError.message);\n              }\n            });\n          }\n        });\n      } else {\n        applySummaryFontSize(size);\n      }\n    });\n  });\n}\n", "/**\n * Popup Settings Management\n * Handles loading and saving settings in the popup UI\n */\n\nimport { DEFAULTS, MESSAGE_ACTIONS, STORAGE_KEYS } from \"../constants.js\";\nimport { saveSetting } from \"../storage.js\";\nimport { setComboboxValue } from \"./combobox.js\";\nimport { log as logDebug } from \"./logger.js\";\n\n/**\n * Load all settings and populate UI\n * @param {Object} elements - DOM elements for settings inputs\n */\nexport function loadSettings(elements) {\n  chrome.storage.local.get(\n    [\n      STORAGE_KEYS.SCRAPE_CREATORS_API_KEY,\n      STORAGE_KEYS.OPENROUTER_API_KEY,\n      STORAGE_KEYS.SUMMARIZER_RECOMMENDED_MODEL,\n      STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL,\n      STORAGE_KEYS.REFINER_RECOMMENDED_MODEL,\n      STORAGE_KEYS.REFINER_CUSTOM_MODEL,\n      STORAGE_KEYS.AUTO_GENERATE,\n      STORAGE_KEYS.SHOW_SUBTITLES,\n      STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED,\n      STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM,\n    ],\n    (result) => {\n      // API Keys\n      if (result[STORAGE_KEYS.SCRAPE_CREATORS_API_KEY] && elements.scrapeApiKey) {\n        elements.scrapeApiKey.value = result[STORAGE_KEYS.SCRAPE_CREATORS_API_KEY];\n      }\n      if (result[STORAGE_KEYS.OPENROUTER_API_KEY] && elements.openrouterApiKey) {\n        elements.openrouterApiKey.value = result[STORAGE_KEYS.OPENROUTER_API_KEY];\n      }\n\n      // Toggles\n      if (elements.autoGenerateToggle) {\n        elements.autoGenerateToggle.checked = result[STORAGE_KEYS.AUTO_GENERATE] === true;\n      }\n      \n      const showSubtitlesValue = result[STORAGE_KEYS.SHOW_SUBTITLES] !== undefined\n        ? result[STORAGE_KEYS.SHOW_SUBTITLES]\n        : DEFAULTS.SHOW_SUBTITLES;\n      if (elements.showSubtitlesToggle) {\n        elements.showSubtitlesToggle.checked = showSubtitlesValue === true;\n      }\n\n      // Update comboboxes (custom takes priority over recommended)\n      // Summarizer\n      const summarizerCustom = result[STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL]?.trim();\n      const summarizerRecommended = result[STORAGE_KEYS.SUMMARIZER_RECOMMENDED_MODEL] || DEFAULTS.MODEL_SUMMARIZER;\n      const summarizerValue = summarizerCustom || summarizerRecommended;\n      setComboboxValue('summarizer', summarizerValue);\n\n      // Refiner\n      const refinerCustom = result[STORAGE_KEYS.REFINER_CUSTOM_MODEL]?.trim();\n      const refinerRecommended = result[STORAGE_KEYS.REFINER_RECOMMENDED_MODEL] || DEFAULTS.MODEL_REFINER;\n      const refinerValue = refinerCustom || refinerRecommended;\n      setComboboxValue('refiner', refinerValue);\n      \n      // Target Language\n      const customLanguage = result[STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM]?.trim();\n      const recommendedLanguage = result[STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED] || DEFAULTS.TARGET_LANGUAGE_RECOMMENDED;\n      const targetLanguageValue = customLanguage || recommendedLanguage;\n      setComboboxValue('targetLanguage', targetLanguageValue);\n    }\n  );\n}\n\n/**\n * Setup settings event listeners\n * @param {Object} elements - DOM elements for settings inputs\n */\nexport function setupSettingsListeners(elements) {\n  // API Keys\n  if (elements.scrapeApiKey) {\n    elements.scrapeApiKey.addEventListener('input', function() {\n      saveSetting(STORAGE_KEYS.SCRAPE_CREATORS_API_KEY, this.value.trim());\n    });\n  }\n\n  if (elements.openrouterApiKey) {\n    elements.openrouterApiKey.addEventListener('input', function() {\n      saveSetting(STORAGE_KEYS.OPENROUTER_API_KEY, this.value.trim());\n    });\n  }\n\n  // Model comboboxes are handled by combobox.js\n\n  // Toggles\n  if (elements.autoGenerateToggle) {\n    elements.autoGenerateToggle.addEventListener('change', function() {\n      saveSetting(STORAGE_KEYS.AUTO_GENERATE, this.checked);\n    });\n  }\n\n  // Show subtitles toggle (special handling for content script communication)\n  if (elements.showSubtitlesToggle) {\n    elements.showSubtitlesToggle.addEventListener('change', function() {\n      const enabled = this.checked;\n      saveSetting(STORAGE_KEYS.SHOW_SUBTITLES, enabled);\n      \n      // Send message to content script to toggle subtitles\n      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n        const currentTab = tabs[0];\n        if (currentTab && currentTab.url && currentTab.url.includes('youtube.com/watch')) {\n          chrome.tabs.sendMessage(\n            currentTab.id,\n            {\n              action: MESSAGE_ACTIONS.TOGGLE_SUBTITLES,\n              showSubtitles: enabled,\n              enabled: enabled,\n            },\n            () => {\n              if (chrome.runtime.lastError) {\n                logDebug('Popup: Unable to toggle subtitles:', chrome.runtime.lastError.message);\n              }\n            }\n          );\n        }\n      });\n    });\n  }\n\n  // Target Language is handled by combobox.js\n}\n\n/**\n * Get current model selection for summarizer\n * @param {Object} result - Storage result object\n * @returns {string} Selected model\n */\nexport function getSummarizerModel(result) {\n  const customModel = result[STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL]?.trim();\n  const recommendedModel = result[STORAGE_KEYS.SUMMARIZER_RECOMMENDED_MODEL]?.trim();\n  return customModel || recommendedModel || DEFAULTS.MODEL_SUMMARIZER;\n}\n\n/**\n * Get current model selection for refiner\n * @param {Object} result - Storage result object\n * @returns {string} Selected model\n */\nexport function getRefinerModel(result) {\n  const customModel = result[STORAGE_KEYS.REFINER_CUSTOM_MODEL]?.trim();\n  const recommendedModel = result[STORAGE_KEYS.REFINER_RECOMMENDED_MODEL]?.trim();\n  return customModel || recommendedModel || DEFAULTS.MODEL_REFINER;\n}\n\n/**\n * Get current target language selection\n * @param {Object} result - Storage result object\n * @returns {string} Selected target language\n */\nexport function getTargetLanguage(result) {\n  const customLanguage = result[STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM]?.trim();\n  const recommendedLanguage = result[STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED]?.trim();\n  return customLanguage || recommendedLanguage || DEFAULTS.TARGET_LANGUAGE_RECOMMENDED;\n}\n", "/**\n * Generation Actions\n * Handles summary and caption generation requests\n */\n\nimport { MESSAGE_ACTIONS, STORAGE_KEYS } from \"../constants.js\";\nimport { getStoredSubtitles } from \"../storage.js\";\nimport { extractVideoId } from \"../url.js\";\nimport { getRefinerModel, getSummarizerModel, getTargetLanguage } from \"./popupSettings.js\";\n\n/**\n * Get current YouTube video tab\n * @returns {Promise<chrome.tabs.Tab>} Current tab or null\n */\nexport async function getCurrentVideoTab() {\n  return new Promise((resolve) => {\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n      const currentTab = tabs[0];\n      if (currentTab && currentTab.url && currentTab.url.includes('youtube.com/watch')) {\n        resolve(currentTab);\n      } else {\n        resolve(null);\n      }\n    });\n  });\n}\n\n/**\n * Check if refined captions exist for current video and update copy button state\n * @param {HTMLElement} copyCaptionBtn - Copy button element\n */\nexport async function checkRefinedCaptionsAvailability(copyCaptionBtn) {\n  if (!copyCaptionBtn) return;\n\n  try {\n    const currentTab = await getCurrentVideoTab();\n\n    if (!currentTab) {\n      copyCaptionBtn.disabled = true;\n      return;\n    }\n\n    const videoId = extractVideoId(currentTab.url);\n    if (!videoId) {\n      copyCaptionBtn.disabled = true;\n      return;\n    }\n\n    const subtitles = await getStoredSubtitles(videoId);\n    copyCaptionBtn.disabled = !subtitles || !Array.isArray(subtitles) || subtitles.length === 0;\n  } catch (error) {\n    console.error('Error checking refined captions:', error);\n    copyCaptionBtn.disabled = true;\n  }\n}\n\n/**\n * Validate API keys and show error if missing\n * @param {Object} result - Storage result\n * @param {HTMLElement} statusElement - Status element to show errors\n * @param {Function} showSettingsView - Function to show settings view\n * @returns {boolean} True if valid\n */\nfunction validateApiKeys(result, statusElement, showSettingsView) {\n  const scrapeKey = result[STORAGE_KEYS.SCRAPE_CREATORS_API_KEY];\n  const openrouterKey = result[STORAGE_KEYS.OPENROUTER_API_KEY];\n\n  if (!scrapeKey) {\n    statusElement.textContent = 'Please enter Scrape Creators API key in Settings';\n    statusElement.className = 'status error';\n    showSettingsView();\n    return false;\n  }\n\n  if (!openrouterKey) {\n    statusElement.textContent = 'Please enter OpenRouter API key in Settings';\n    statusElement.className = 'status error';\n    showSettingsView();\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Generate summary for current video\n * @param {Object} elements - DOM elements\n * @param {Function} showSettingsView - Function to show settings view\n */\nexport async function generateSummary(elements, showSettingsView) {\n  if (elements.generateSummaryBtn.disabled || elements.generateCaptionBtn.disabled) {\n    return;\n  }\n\n  elements.status.textContent = '';\n  elements.status.className = 'status';\n\n  // Get settings\n  chrome.storage.local.get(\n    [\n      STORAGE_KEYS.SCRAPE_CREATORS_API_KEY,\n      STORAGE_KEYS.OPENROUTER_API_KEY,\n      STORAGE_KEYS.SUMMARIZER_RECOMMENDED_MODEL,\n      STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL,\n      STORAGE_KEYS.REFINER_RECOMMENDED_MODEL,\n      STORAGE_KEYS.REFINER_CUSTOM_MODEL,\n      STORAGE_KEYS.TARGET_LANGUAGE_RECOMMENDED,\n      STORAGE_KEYS.TARGET_LANGUAGE_CUSTOM,\n    ],\n    async (result) => {\n      // Validate API keys\n      if (!validateApiKeys(result, elements.status, showSettingsView)) {\n        return;\n      }\n\n      // Get models and target language from combobox inputs (takes priority) or storage\n      const summarizerModel = elements.summarizerInput?.value.trim() || getSummarizerModel(result);\n      const refinerModel = elements.refinerInput?.value.trim() || getRefinerModel(result);\n      const targetLanguage = elements.targetLanguageInput?.value.trim() || getTargetLanguage(result);\n\n      // Show loading state\n      elements.status.textContent = 'Generating summary...';\n      elements.generateSummaryBtn.disabled = true;\n      elements.generateCaptionBtn.disabled = true;\n      elements.summaryContent.innerHTML = '<div class=\"summary-placeholder\">Generating summary, please wait...</div>';\n\n      // Get current tab\n      const currentTab = await getCurrentVideoTab();\n      if (!currentTab) {\n        elements.status.textContent = 'Not a YouTube video page';\n        elements.status.className = 'status error';\n        elements.generateSummaryBtn.disabled = false;\n        elements.generateCaptionBtn.disabled = false;\n        return;\n      }\n\n      const videoId = extractVideoId(currentTab.url);\n      if (!videoId) {\n        elements.status.textContent = 'Could not extract video ID';\n        elements.status.className = 'status error';\n        elements.generateSummaryBtn.disabled = false;\n        elements.generateCaptionBtn.disabled = false;\n        return;\n      }\n\n      // Send message to content script\n      chrome.tabs.sendMessage(\n        currentTab.id,\n        {\n          action: MESSAGE_ACTIONS.GENERATE_SUMMARY,\n          videoId: videoId,\n          scrapeCreatorsApiKey: result[STORAGE_KEYS.SCRAPE_CREATORS_API_KEY],\n          openRouterApiKey: result[STORAGE_KEYS.OPENROUTER_API_KEY],\n          modelSelection: summarizerModel,\n          targetLanguage: targetLanguage,\n        },\n        (response) => {\n          if (chrome.runtime.lastError) {\n            elements.status.textContent = 'Error: ' + chrome.runtime.lastError.message;\n            elements.status.className = 'status error';\n            elements.generateSummaryBtn.disabled = false;\n            elements.generateCaptionBtn.disabled = false;\n            elements.summaryContent.innerHTML = '<div class=\"summary-placeholder\">Failed to generate summary. Please try again.</div>';\n          } else if (response && response.status === 'started') {\n            elements.status.textContent = 'Processing video transcript...';\n          } else if (response && response.status === 'error') {\n            const errorMsg = response.message || 'Unknown error';\n            elements.status.textContent = 'Error: ' + errorMsg;\n            elements.status.className = 'status error';\n            elements.generateSummaryBtn.disabled = false;\n            elements.generateCaptionBtn.disabled = false;\n            // Don't clear summary content if it's just a \"already running\" error\n            if (!errorMsg.includes('already in progress')) {\n              elements.summaryContent.innerHTML = '<div class=\"summary-placeholder\">Failed to generate summary. Please try again.</div>';\n            }\n          }\n        }\n      );\n    }\n  );\n}\n\n/**\n * Generate captions for current video\n * @param {Object} elements - DOM elements\n * @param {Function} showSettingsView - Function to show settings view\n */\nexport async function generateCaptions(elements, showSettingsView) {\n  if (elements.generateSummaryBtn.disabled || elements.generateCaptionBtn.disabled) {\n    return;\n  }\n\n  elements.status.textContent = '';\n  elements.status.className = 'status';\n\n  chrome.storage.local.get(\n    [\n      STORAGE_KEYS.SCRAPE_CREATORS_API_KEY,\n      STORAGE_KEYS.OPENROUTER_API_KEY,\n      STORAGE_KEYS.REFINER_RECOMMENDED_MODEL,\n      STORAGE_KEYS.REFINER_CUSTOM_MODEL,\n    ],\n    async (result) => {\n      // Validate API keys\n      if (!validateApiKeys(result, elements.status, showSettingsView)) {\n        return;\n      }\n\n      const refinerModel = elements.refinerInput?.value.trim() || getRefinerModel(result);\n\n      // Show loading state\n      elements.status.textContent = 'Generating refined captions...';\n      elements.generateCaptionBtn.disabled = true;\n      elements.generateSummaryBtn.disabled = true;\n\n      // Get current tab\n      const currentTab = await getCurrentVideoTab();\n      if (!currentTab) {\n        elements.status.textContent = 'Not a YouTube video page';\n        elements.status.className = 'status error';\n        elements.generateCaptionBtn.disabled = false;\n        elements.generateSummaryBtn.disabled = false;\n        return;\n      }\n\n      const videoId = extractVideoId(currentTab.url);\n      if (!videoId) {\n        elements.status.textContent = 'Could not extract video ID';\n        elements.status.className = 'status error';\n        elements.generateCaptionBtn.disabled = false;\n        elements.generateSummaryBtn.disabled = false;\n        return;\n      }\n\n      // Send message to content script\n      chrome.tabs.sendMessage(\n        currentTab.id,\n        {\n          action: MESSAGE_ACTIONS.GENERATE_SUBTITLES,\n          videoId: videoId,\n          scrapeCreatorsApiKey: result[STORAGE_KEYS.SCRAPE_CREATORS_API_KEY],\n          openRouterApiKey: result[STORAGE_KEYS.OPENROUTER_API_KEY],\n          modelSelection: refinerModel,\n          forceRegenerate: true,\n        },\n        (response) => {\n          if (chrome.runtime.lastError) {\n            elements.status.textContent = 'Error: ' + chrome.runtime.lastError.message;\n            elements.status.className = 'status error';\n            elements.generateCaptionBtn.disabled = false;\n            elements.generateSummaryBtn.disabled = false;\n          } else if (response && response.status === 'started') {\n            elements.status.textContent = 'Fetching and refining transcript...';\n          } else if (response && response.status === 'error') {\n            elements.status.textContent = 'Error: ' + (response.message || 'Unknown error');\n            elements.status.className = 'status error';\n            elements.generateCaptionBtn.disabled = false;\n            elements.generateSummaryBtn.disabled = false;\n          }\n        }\n      );\n    }\n  );\n}\n", "/**\n * Load existing summary for current video\n * Checks storage and displays summary if found\n */\n\nimport { extractVideoId } from \"../url.js\";\nimport { getCurrentVideoTab } from \"./generation.js\";\nimport { log as logDebug } from \"./logger.js\";\nimport { displaySummary } from \"./ui.js\";\n\n/**\n * Load and display summary for current video\n * @param {Object} elements - DOM elements\n */\nexport async function loadExistingSummary(elements) {\n  try {\n    // Get current tab\n    const currentTab = await getCurrentVideoTab();\n    if (!currentTab) {\n      return;\n    }\n\n    const videoId = extractVideoId(currentTab.url);\n    if (!videoId) {\n      return;\n    }\n\n    // Check for existing summary\n    chrome.storage.local.get([`summary_${videoId}`], (result) => {\n      if (result[`summary_${videoId}`] && elements.summaryContent) {\n        logDebug('Popup: Found existing summary for video:', videoId);\n        displaySummary(result[`summary_${videoId}`], elements.summaryContent);\n      }\n    });\n  } catch (error) {\n    logDebug('Popup: Error loading existing summary:', error);\n  }\n}\n", "/**\n * Message Handler for Popup\n * Handles messages from background and content scripts\n */\n\nimport { MESSAGE_ACTIONS, STORAGE_KEYS } from \"../constants.js\";\nimport { checkRefinedCaptionsAvailability } from \"./generation.js\";\nimport { convertMarkdownToHTML } from \"./ui.js\";\n\n/**\n * Handle model error by clearing invalid custom models\n * @param {Object} elements - DOM elements\n * @param {string} errorMessage - Error message\n */\nfunction handleModelError(elements, errorMessage) {\n  const clears = {};\n  let clearedCount = 0;\n\n  if (elements.summarizerCustomModel && elements.summarizerCustomModel.value.trim()) {\n    elements.summarizerCustomModel.value = '';\n    clears[STORAGE_KEYS.SUMMARIZER_CUSTOM_MODEL] = '';\n    clearedCount++;\n  }\n\n  if (elements.refinerCustomModel && elements.refinerCustomModel.value.trim()) {\n    elements.refinerCustomModel.value = '';\n    clears[STORAGE_KEYS.REFINER_CUSTOM_MODEL] = '';\n    clearedCount++;\n  }\n\n  if (Object.keys(clears).length > 0) {\n    chrome.storage.local.set(clears, () => {\n      console.log('Popup: Cleared invalid custom models');\n    });\n    \n    alert(\n      `Model Error: ${errorMessage}\\n\\n` +\n      `Invalid custom model input detected and cleared. ` +\n      `Now using recommended models for summarizer and refiner. ` +\n      `Please check your custom model entries if needed.`\n    );\n  } else {\n    alert(\n      `Model Error: ${errorMessage}\\n\\n` +\n      `Please check your model selection in Settings and ensure it's a valid OpenRouter model ID.`\n    );\n  }\n}\n\n/**\n * Safely convert error to string and lowercase\n * @param {*} error - Error (can be string, object, array, etc.)\n * @returns {string} Lowercased error string\n */\nfunction errorToString(error) {\n  if (typeof error === 'string') {\n    return error.toLowerCase();\n  }\n  if (error instanceof Error) {\n    return error.message.toLowerCase();\n  }\n  if (typeof error === 'object' && error !== null) {\n    // Try to extract meaningful error message from object\n    if (error.message) {\n      return String(error.message).toLowerCase();\n    }\n    if (error.error) {\n      return errorToString(error.error);\n    }\n    // Fallback: stringify the object\n    return JSON.stringify(error).toLowerCase();\n  }\n  return String(error).toLowerCase();\n}\n\n/**\n * Check if error is a model-related error\n * @param {*} error - Error message (can be string, object, etc.)\n * @returns {boolean} True if model error\n */\nfunction isModelError(error) {\n  const lowerError = errorToString(error);\n  return (\n    lowerError.includes('invalid model') ||\n    lowerError.includes('not a valid model id') ||\n    lowerError.includes('model not found') ||\n    lowerError.includes('openrouter')\n  );\n}\n\n/**\n * Setup message listener for popup\n * @param {Object} elements - DOM elements\n */\nexport function setupMessageListener(elements) {\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    if (message.action === MESSAGE_ACTIONS.SHOW_ERROR) {\n      elements.status.className = 'status error';\n      \n      const errorString = typeof message.error === 'string' \n        ? message.error \n        : (message.error?.message || JSON.stringify(message.error) || 'Unknown error');\n      const isModel = isModelError(message.error);\n      \n      if (isModel && (elements.summarizerCustomModel || elements.refinerCustomModel)) {\n        handleModelError(elements, errorString);\n      } else if (isModel) {\n        alert(\n          `Model Error: ${errorString}\\n\\n` +\n          `Please check your model selection in Settings and ensure it's a valid OpenRouter model ID.`\n        );\n      } else {\n        elements.status.textContent = `Error: ${errorString}`;\n      }\n    } else if (message.action === MESSAGE_ACTIONS.UPDATE_POPUP_STATUS) {\n      if (message.error) {\n        elements.status.className = 'status error';\n        elements.generateSummaryBtn.disabled = false;\n        elements.generateCaptionBtn.disabled = false;\n        elements.summaryContent.innerHTML = '<div class=\"summary-placeholder\">Failed to generate summary. Please try again.</div>';\n        \n        const errorString = typeof message.error === 'string' \n          ? message.error \n          : (message.error?.message || JSON.stringify(message.error) || 'Unknown error');\n        const isModel = isModelError(message.error);\n        \n        if (isModel && (elements.summarizerCustomModel || elements.refinerCustomModel)) {\n          handleModelError(elements, errorString);\n        } else {\n          elements.status.textContent = message.text || `Error: ${errorString}`;\n        }\n      } else if (message.success) {\n        elements.status.className = 'status success';\n        elements.generateSummaryBtn.disabled = false;\n        elements.generateCaptionBtn.disabled = false;\n        // Check if refined captions are now available (for copy button)\n        checkRefinedCaptionsAvailability(elements.copyCaptionBtn);\n      } else {\n        elements.status.textContent = message.text;\n        // Also check when status updates (captions might have been generated)\n        if (message.text && (message.text.includes('ready') || message.text.includes('complete') || message.text.includes('success'))) {\n          // Small delay to ensure storage is updated\n          setTimeout(() => {\n            checkRefinedCaptionsAvailability(elements.copyCaptionBtn);\n          }, 500);\n        }\n      }\n    } else if (message.action === 'SUMMARY_GENERATED') {\n      if (message.summary) {\n        displaySummary(message.summary, elements.summaryContent);\n        elements.status.textContent = 'Summary generated successfully!';\n        elements.status.className = 'status success';\n        \n        // Note: Summary is already saved by background script, no need to save again here\n        \n        setTimeout(() => {\n          elements.status.textContent = '';\n          elements.status.className = 'status';\n        }, 3000);\n      }\n      elements.generateSummaryBtn.disabled = false;\n      elements.generateCaptionBtn.disabled = false;\n    }\n  });\n}\n\n/**\n * Display summary in the UI\n * @param {string} summaryText - Summary text (markdown)\n * @param {HTMLElement} summaryElement - Summary content element\n */\nfunction displaySummary(summaryText, summaryElement) {\n  summaryElement.innerHTML = convertMarkdownToHTML(summaryText);\n}\n", "/**\n * Tooltip Management\n * Handles info icon tooltips with delay functionality\n */\n\n/**\n * Initialize tooltips for all info icons\n */\nexport function initializeTooltips() {\n  const infoIcons = document.querySelectorAll('.info-icon');\n  const iconTooltips = new Map(); // Track icon -> tooltip element\n  \n  infoIcons.forEach(icon => {\n    // Wrap icon if not already wrapped\n    let wrapper = icon.parentElement;\n    if (!wrapper || !wrapper.classList.contains('info-icon-wrapper')) {\n      wrapper = document.createElement('span');\n      wrapper.className = 'info-icon-wrapper';\n      icon.parentNode.insertBefore(wrapper, icon);\n      wrapper.appendChild(icon);\n    }\n    \n    // Create tooltip element and append to wrapper\n    const tooltip = document.createElement('div');\n    tooltip.className = 'info-tooltip';\n    tooltip.textContent = icon.getAttribute('data-tooltip');\n    wrapper.appendChild(tooltip);\n    \n    // Store reference\n    iconTooltips.set(icon, { tooltip: tooltip, hideTimeout: null });\n\n    // Setup event listeners\n    setupTooltipListeners(icon, iconTooltips.get(icon));\n  });\n}\n\n/**\n * Setup event listeners for a tooltip\n * @param {HTMLElement} icon - Info icon element\n * @param {Object} state - Tooltip state object\n */\nfunction setupTooltipListeners(icon, state) {\n  const { tooltip } = state;\n\n  icon.addEventListener('mouseenter', function() {\n    // Clear any pending hide timeout\n    if (state.hideTimeout) {\n      clearTimeout(state.hideTimeout);\n      state.hideTimeout = null;\n    }\n    \n    // Show tooltip\n    tooltip.classList.remove('hide');\n    tooltip.classList.add('show');\n  });\n\n  icon.addEventListener('mouseleave', function(e) {\n    // Start delay - will be cancelled if mouse enters tooltip\n    state.hideTimeout = setTimeout(() => {\n      tooltip.classList.remove('show');\n      tooltip.classList.add('hide');\n      state.hideTimeout = null;\n    }, 2000);\n  });\n\n  // Keep tooltip visible when hovering over it\n  tooltip.addEventListener('mouseenter', function() {\n    if (state.hideTimeout) {\n      clearTimeout(state.hideTimeout);\n      state.hideTimeout = null;\n    }\n    tooltip.classList.remove('hide');\n    tooltip.classList.add('show');\n  });\n\n  tooltip.addEventListener('mouseleave', function() {\n    // Delay before hiding\n    state.hideTimeout = setTimeout(() => {\n      tooltip.classList.remove('show');\n      tooltip.classList.add('hide');\n      state.hideTimeout = null;\n    }, 500);\n  });\n}\n", "/**\n * Popup Script for Better YouTube Caption Extension\n * Main entry point for popup UI\n */\n\nimport { getStoredSubtitles } from \"./storage.js\";\nimport { extractVideoId } from \"./url.js\";\nimport { initializeComboboxes } from \"./utils/combobox.js\";\nimport { initializeFontSizeSelectors } from \"./utils/fontSize.js\";\nimport { checkRefinedCaptionsAvailability, generateCaptions, generateSummary } from \"./utils/generation.js\";\nimport { loadExistingSummary } from \"./utils/loadSummary.js\";\nimport { setupMessageListener } from \"./utils/messageHandler.js\";\nimport { loadSettings, setupSettingsListeners } from \"./utils/popupSettings.js\";\nimport { initializeTooltips } from \"./utils/tooltip.js\";\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  // DOM Elements\n  const elements = {\n    // Views\n    mainView: document.getElementById('mainView'),\n    settingsView: document.getElementById('settingsView'),\n    \n    // Buttons\n    settingsBtn: document.getElementById('settingsBtn'),\n    backBtn: document.getElementById('backBtn'),\n    generateSummaryBtn: document.getElementById('generateSummaryBtn'),\n    generateCaptionBtn: document.getElementById('generateCaptionBtn'),\n    copyCaptionBtn: document.getElementById('copyCaptionBtn'),\n    \n    // Content\n    summaryContent: document.getElementById('summaryContent'),\n    status: document.getElementById('status'),\n    \n    // Form inputs\n    scrapeApiKey: document.getElementById('scrapeApiKey'),\n    openrouterApiKey: document.getElementById('openrouterApiKey'),\n    summarizerInput: document.getElementById('summarizerInput'),\n    refinerInput: document.getElementById('refinerInput'),\n    autoGenerateToggle: document.getElementById('autoGenerateToggle'),\n    showSubtitlesToggle: document.getElementById('showSubtitlesToggle'),\n    targetLanguageInput: document.getElementById('targetLanguageInput'),\n  };\n\n  // View Management\n  function showMainView() {\n    elements.mainView.classList.add('active');\n    elements.settingsView.classList.remove('active');\n  }\n\n  function showSettingsView() {\n    elements.mainView.classList.remove('active');\n    elements.settingsView.classList.add('active');\n  }\n\n  // Setup navigation\n  if (elements.settingsBtn) {\n    elements.settingsBtn.addEventListener('click', showSettingsView);\n  }\n  if (elements.backBtn) {\n    elements.backBtn.addEventListener('click', showMainView);\n  }\n\n  /**\n   * Copy refined caption to clipboard\n   */\n  async function copyRefinedCaption() {\n    if (elements.copyCaptionBtn?.disabled) {\n      return;\n    }\n\n    try {\n      const currentTab = await new Promise((resolve) => {\n        chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n          resolve(tabs[0]);\n        });\n      });\n\n      if (!currentTab || !currentTab.url || !currentTab.url.includes('youtube.com/watch')) {\n        elements.status.textContent = 'Not a YouTube video page';\n        elements.status.className = 'status error';\n        return;\n      }\n\n      const videoId = extractVideoId(currentTab.url);\n      if (!videoId) {\n        elements.status.textContent = 'Could not extract video ID';\n        elements.status.className = 'status error';\n        return;\n      }\n\n      const subtitles = await getStoredSubtitles(videoId);\n      if (!subtitles || !Array.isArray(subtitles) || subtitles.length === 0) {\n        elements.status.textContent = 'No refined captions available';\n        elements.status.className = 'status error';\n        return;\n      }\n\n      // Join all segment texts with spaces (replacing newlines)\n      const captionText = subtitles\n        .map((segment) => (segment.text || '').replace(/\\n/g, ' ').trim())\n        .filter((text) => text.length > 0)\n        .join(' ');\n\n      // Copy to clipboard\n      await navigator.clipboard.writeText(captionText);\n      \n      // Show success message\n      elements.status.textContent = 'Refined caption copied to clipboard!';\n      elements.status.className = 'status success';\n      \n      setTimeout(() => {\n        elements.status.textContent = '';\n        elements.status.className = 'status';\n      }, 2000);\n    } catch (error) {\n      console.error('Error copying refined caption:', error);\n      elements.status.textContent = 'Failed to copy caption';\n      elements.status.className = 'status error';\n    }\n  }\n\n  // Initialize components\n  initializeComboboxes();\n  loadSettings(elements);\n  setupSettingsListeners(elements);\n  initializeFontSizeSelectors(elements);\n  initializeTooltips();\n  setupMessageListener(elements);\n  loadExistingSummary(elements);\n  checkRefinedCaptionsAvailability(elements.copyCaptionBtn);\n\n  // Setup generation buttons\n  if (elements.generateSummaryBtn) {\n    elements.generateSummaryBtn.addEventListener('click', () => {\n      generateSummary(elements, showSettingsView);\n    });\n  }\n\n  if (elements.generateCaptionBtn) {\n    elements.generateCaptionBtn.addEventListener('click', () => {\n      generateCaptions(elements, showSettingsView);\n    });\n  }\n\n  // Setup copy button\n  if (elements.copyCaptionBtn) {\n    elements.copyCaptionBtn.addEventListener('click', copyRefinedCaption);\n  }\n});\n\n"],
  "mappings": "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",
  "names": ["STORAGE_KEYS", "STORAGE", "RECOMMENDED_SUMMARIZER_MODELS", "RECOMMENDED_REFINER_MODELS", "TARGET_LANGUAGES", "DEFAULTS", "FONT_SIZES", "MESSAGE_ACTIONS", "PREFIX", "DEBUG", "log", "args", "getStoredSubtitles", "videoId", "resolve", "result", "saveSetting", "key", "value", "settings", "log", "extractVideoId", "url", "e", "getProviderIcon", "provider", "escapeHTML", "text", "div", "formatInlineMarkdown", "part", "index", "convertMarkdownToHTML", "markdown", "lines", "result", "inList", "inParagraph", "i", "line", "headerText", "listItemText", "displaySummary", "summaryText", "summaryElement", "initializeComboboxes", "combobox", "comboboxType", "input", "arrow", "dropdown", "icon", "options", "storageKeys", "TARGET_LANGUAGES", "STORAGE_KEYS", "RECOMMENDED_SUMMARIZER_MODELS", "RECOMMENDED_REFINER_MODELS", "option", "item", "createComboboxItem", "e", "toggleCombobox", "filterComboboxDropdown", "value", "updateComboboxModelIcon", "saveSetting", "updateComboboxIcon", "i", "emojiMatch", "provider", "iconSrc", "getProviderIcon", "img", "label", "isOpen", "cb", "filterText", "items", "filterLower", "langOption", "l", "setComboboxValue", "comboboxType", "value", "combobox", "input", "icon", "updateComboboxIcon", "updateComboboxModelIcon", "dropdown", "item", "applySummaryFontSize", "size", "sizeConfig", "FONT_SIZES", "summaryContent", "initializeFontSizeSelectors", "STORAGE_KEYS", "result", "captionSize", "DEFAULTS", "summarySize", "btn", "button", "type", "storageKey", "saveSetting", "tabs", "currentTab", "MESSAGE_ACTIONS", "log", "loadSettings", "elements", "STORAGE_KEYS", "result", "showSubtitlesValue", "DEFAULTS", "summarizerCustom", "summarizerRecommended", "setComboboxValue", "refinerCustom", "refinerRecommended", "customLanguage", "recommendedLanguage", "setupSettingsListeners", "saveSetting", "enabled", "tabs", "currentTab", "MESSAGE_ACTIONS", "log", "getSummarizerModel", "customModel", "recommendedModel", "getRefinerModel", "getTargetLanguage", "getCurrentVideoTab", "resolve", "tabs", "currentTab", "checkRefinedCaptionsAvailability", "copyCaptionBtn", "videoId", "extractVideoId", "subtitles", "getStoredSubtitles", "error", "validateApiKeys", "result", "statusElement", "showSettingsView", "scrapeKey", "STORAGE_KEYS", "openrouterKey", "generateSummary", "elements", "summarizerModel", "getSummarizerModel", "refinerModel", "getRefinerModel", "targetLanguage", "getTargetLanguage", "MESSAGE_ACTIONS", "response", "errorMsg", "generateCaptions", "loadExistingSummary", "elements", "currentTab", "getCurrentVideoTab", "videoId", "extractVideoId", "result", "log", "displaySummary", "error", "handleModelError", "elements", "errorMessage", "clears", "clearedCount", "STORAGE_KEYS", "errorToString", "error", "isModelError", "lowerError", "setupMessageListener", "message", "sender", "sendResponse", "MESSAGE_ACTIONS", "errorString", "isModel", "checkRefinedCaptionsAvailability", "displaySummary", "summaryText", "summaryElement", "convertMarkdownToHTML", "initializeTooltips", "infoIcons", "iconTooltips", "icon", "wrapper", "tooltip", "setupTooltipListeners", "state", "e", "elements", "showMainView", "showSettingsView", "copyRefinedCaption", "currentTab", "resolve", "tabs", "videoId", "extractVideoId", "subtitles", "getStoredSubtitles", "captionText", "segment", "text", "error", "initializeComboboxes", "loadSettings", "setupSettingsListeners", "initializeFontSizeSelectors", "initializeTooltips", "setupMessageListener", "loadExistingSummary", "checkRefinedCaptionsAvailability", "generateSummary", "generateCaptions"]
}
